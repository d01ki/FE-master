{% extends "base.html" %}

{% block title %}
{% if error_code == 404 %}
    ページが見つかりません - FE-Master
{% elif error_code == 403 %}
    アクセス権限がありません - FE-Master
{% elif error_code == 500 %}
    サーバーエラー - FE-Master
{% else %}
    エラー - FE-Master
{% endif %}
{% endblock %}

{% block content %}
<div class="max-w-2xl mx-auto text-center py-16">
    <!-- エラーアイコン -->
    <div class="mb-8">
        <div class="w-24 h-24 mx-auto rounded-full flex items-center justify-center
                    {% if error_code == 404 %}bg-blue-100{% elif error_code == 403 %}bg-yellow-100{% else %}bg-red-100{% endif %}">
            <i class="text-5xl
                      {% if error_code == 404 %}fas fa-search text-blue-500{% elif error_code == 403 %}fas fa-lock text-yellow-500{% else %}fas fa-exclamation-triangle text-red-500{% endif %}">
            </i>
        </div>
    </div>

    <!-- エラーコード -->
    <div class="text-6xl font-bold mb-4
                {% if error_code == 404 %}text-blue-300{% elif error_code == 403 %}text-yellow-300{% else %}text-red-300{% endif %}">
        {{ error_code or '500' }}
    </div>

    <!-- エラータイトル -->
    <h1 class="text-3xl font-bold mb-4">
        {% if error_code == 404 %}
            ページが見つかりません
        {% elif error_code == 403 %}
            アクセス権限がありません
        {% elif error_code == 500 %}
            サーバーエラーが発生しました
        {% else %}
            エラーが発生しました
        {% endif %}
    </h1>

    <!-- エラーメッセージ -->
    <p class="text-gray-600 mb-8 text-lg">
        {% if message %}
            {{ message }}
        {% elif error_code == 404 %}
            お探しのページは存在しないか、移動または削除された可能性があります。
        {% elif error_code == 403 %}
            このページにアクセスする権限がありません。ログインが必要な場合があります。
        {% elif error_code == 500 %}
            予期しないエラーが発生しました。しばらく時間をおいて再度お試しください。
        {% else %}
            予期しないエラーが発生しました。
        {% endif %}
    </p>

    <!-- 推奨アクション -->
    <div class="bg-gray-50 border border-gray-200 rounded-lg p-6 mb-8 text-left">
        <h3 class="text-gray-800 font-semibold mb-3 flex items-center">
            <i class="fas fa-info-circle mr-2 text-blue-500"></i>推奨アクション
        </h3>
        <ul class="text-sm text-gray-700 space-y-2">
            {% if error_code == 404 %}
                <li class="flex items-start">
                    <i class="fas fa-chevron-right mr-2 mt-1 text-blue-500"></i>
                    <span>URLが正しいか確認してください</span>
                </li>
                <li class="flex items-start">
                    <i class="fas fa-chevron-right mr-2 mt-1 text-blue-500"></i>
                    <span>ダッシュボードから目的のページに移動してください</span>
                </li>
            {% elif error_code == 403 %}
                <li class="flex items-start">
                    <i class="fas fa-chevron-right mr-2 mt-1 text-yellow-500"></i>
                    <span>ログインしているか確認してください</span>
                </li>
                <li class="flex items-start">
                    <i class="fas fa-chevron-right mr-2 mt-1 text-yellow-500"></i>
                    <span>必要な権限があるか確認してください</span>
                </li>
            {% else %}
                <li class="flex items-start">
                    <i class="fas fa-chevron-right mr-2 mt-1 text-red-500"></i>
                    <span>ページを再読み込みしてみてください</span>
                </li>
                <li class="flex items-start">
                    <i class="fas fa-chevron-right mr-2 mt-1 text-red-500"></i>
                    <span>問題が続く場合は管理者にお問い合わせください</span>
                </li>
            {% endif %}
        </ul>
    </div>

    <!-- アクションボタン -->
    <div class="flex flex-col sm:flex-row gap-4 justify-center">
        {% if error_code in [403, 401] and not session.get('user_id') %}
            <a href="{{ url_for('auth.login') }}" class="inline-flex items-center justify-center px-6 py-3 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition-all duration-200">
                <i class="fas fa-sign-in-alt mr-2"></i>ログイン
            </a>
        {% endif %}
        
        <a href="{{ url_for('main.index') }}" class="inline-flex items-center justify-center px-6 py-3 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition-all duration-200">
            <i class="fas fa-home mr-2"></i>ホームに戻る
        </a>
        
        {% if error_code not in [404] %}
        <button onclick="location.reload()" class="inline-flex items-center justify-center px-6 py-3 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-all duration-200">
            <i class="fas fa-redo mr-2"></i>再読み込み
        </button>
        {% endif %}
        
        <button onclick="history.back()" class="inline-flex items-center justify-center px-6 py-3 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition-all duration-200">
            <i class="fas fa-arrow-left mr-2"></i>前のページ
        </button>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
// エラー報告機能（オプション）
function reportError() {
    const errorData = {
        code: '{{ error_code }}',
        message: '{{ message|safe }}',
        url: window.location.href,
        timestamp: new Date().toISOString()
    };
    
    // 管理者に通知するAPIエンドポイントにPOST（実装は任意）
    console.log('Error reported:', errorData);
}
</script>
{% endblock %}
